<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>TronAdsFaucet - Watch Ads, Earn TRON</title>
    
    <script src="https://js.onclckvd.com/in-stream-ad-admanager/tma.js"></script>
    
    <script src="https://adexora.com/cdn/ads.js?id=494"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --tg-theme-bg-color: #ffffff;
            --tg-theme-text-color: #1e293b;
            --tg-theme-button-color: #d62939;
            --tg-theme-button-text-color: #ffffff;
            --tg-theme-hint-color: #64748b;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #d62939;
            --secondary-bg-color: #f8fafc;
            --border-color: #e2e8f0;
            --accent-color: #d62939;
            --gradient-primary: linear-gradient(135deg, #d62939 0%, #b71c1c 100%);
            --gradient-secondary: linear-gradient(135deg, #d62939 0%, #9c1c1c 100%);
            --gradient-success: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --gradient-warning: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            --gradient-card: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            --shadow: 0 10px 25px rgba(214, 41, 57, 0.15);
            --shadow-light: 0 5px 15px rgba(214, 41, 57, 0.1);
            --radius: 16px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            padding: 20px 15px 100px 15px;
        }

        .view {
            display: none;
            width: 100%;
            animation: fadeInUp 0.5s ease-out;
        }

        #home-view {
            display: block;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            50% { transform: translateY(-10px); }
        }

        /* Header Styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            animation: fadeInUp 0.6s ease-out;
        }

        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
        }

        .logo {
            width: 70px;
            height: 70px;
            background: var(--gradient-primary);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
            animation: float 3s ease-in-out infinite;
        }

        .logo i {
            font-size: 32px;
            color: white;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(90deg, #d62939, #b71c1c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .header p {
            color: var(--tg-theme-hint-color);
            font-size: 16px;
        }

        .admin-header-btn {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--gradient-warning);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 10px 15px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: var(--shadow-light);
            transition: var(--transition);
        }

        .admin-header-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        /* Card Styles */
        .card {
            background: var(--gradient-card);
            padding: 25px;
            border-radius: var(--radius);
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(214, 41, 57, 0.2);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
        }

        .card h2 {
            margin: 0 0 15px 0;
            font-size: 16px;
            color: var(--tg-theme-hint-color);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card h2 i {
            color: var(--accent-color);
        }

        /* Balance Styles */
        .balance-amount {
            font-size: 42px;
            font-weight: 700;
            color: var(--tg-theme-text-color);
            margin-bottom: 10px;
            text-align: center;
            background: linear-gradient(90deg, #d62939, #b71c1c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s infinite;
        }

        /* Grid Styles */
        .ad-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            text-align: center;
        }

        .ad-info-item {
            background: rgba(214, 41, 57, 0.05);
            padding: 15px;
            border-radius: 12px;
            transition: var(--transition);
            border: 1px solid var(--border-color);
        }

        .ad-info-item:hover {
            background: rgba(214, 41, 57, 0.1);
            transform: translateY(-3px);
        }

        .ad-info-item h3 {
            font-size: 20px;
            font-weight: 600;
            margin: 0 0 5px 0;
            color: var(--tg-theme-text-color);
        }

        .ad-info-item p {
            font-size: 14px;
            color: var(--tg-theme-hint-color);
            margin: 0;
        }

        /* Button Styles */
        .btn {
            width: 100%;
            padding: 18px;
            font-size: 18px;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: var(--shadow-light);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: var(--tg-theme-button-text-color);
        }

        .btn-success {
            background: var(--gradient-success);
            color: var(--tg-theme-button-text-color);
        }

        .btn-warning {
            background: var(--gradient-warning);
            color: var(--tg-theme-button-text-color);
        }

        .btn:disabled {
            background: #cbd5e1;
            color: #64748b;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        .btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .btn:disabled::before {
            display: none;
        }

        .ad-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }

        /* Loading Button */
        .btn-loading {
            position: relative;
            pointer-events: none;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid transparent;
            border-top: 2px solid #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Status Message */
        .status-message {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 480px;
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 500;
            display: none;
            animation: slideInUp 0.3s ease-out;
            z-index: 1000;
            box-sizing: border-box;
            box-shadow: var(--shadow);
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
            border-left: 4px solid;
            color: var(--tg-theme-text-color);
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .success {
            display: block;
            border-left-color: var(--success-color);
        }

        .error {
            display: block;
            border-left-color: var(--danger-color);
        }

        .info {
            display: block;
            border-left-color: var(--tg-theme-button-color);
        }

        /* Footer Navigation */
        .footer-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--secondary-bg-color);
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            box-shadow: 0 -5px 20px rgba(214, 41, 57, 0.1);
            border-top: 1px solid var(--border-color);
            z-index: 999;
            backdrop-filter: blur(10px);
        }

        .nav-btn {
            background: none;
            border: none;
            color: var(--tg-theme-hint-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 12px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: var(--transition);
            z-index: -1;
        }

        .nav-btn.active {
            color: white;
        }

        .nav-btn.active::before {
            opacity: 1;
        }

        .nav-btn:hover:not(.active) {
            color: var(--tg-theme-text-color);
            transform: translateY(-3px);
        }

        .nav-btn .icon {
            width: 24px;
            height: 24px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .nav-btn.active .icon {
            animation: bounce 0.5s;
        }

        /* Input Styles */
        .input-group {
            margin-bottom: 20px;
            text-align: left;
            animation: fadeInUp 0.5s ease-out;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--tg-theme-hint-color);
            font-size: 14px;
            font-weight: 500;
        }

        .input-group input, .input-group textarea, .input-group select {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            background: rgba(255, 255, 255, 0.8);
            color: var(--tg-theme-text-color);
            font-size: 16px;
            box-sizing: border-box;
            transition: var(--transition);
        }

        .input-group input:focus, .input-group textarea:focus, .input-group select:focus {
            outline: none;
            border-color: var(--tg-theme-button-color);
            box-shadow: 0 0 0 3px rgba(214, 41, 57, 0.2);
            background: rgba(255, 255, 255, 1);
        }

        /* Referral Styles */
        .referral-input-container {
            margin-top: 20px;
            padding: 20px;
            background: rgba(214, 41, 57, 0.05);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            animation: fadeInUp 0.5s ease-out;
        }

        .referral-input-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .referral-input-group input {
            flex: 1;
            padding: 14px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            background: rgba(255, 255, 255, 0.8);
            color: var(--tg-theme-text-color);
        }

        .referral-input-group button {
            padding: 14px 20px;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .referral-input-group button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .referral-code-box {
            background: rgba(214, 41, 57, 0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px dashed var(--tg-theme-hint-color);
            margin-top: 15px;
            cursor: pointer;
            color: var(--tg-theme-text-color);
            transition: var(--transition);
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            letter-spacing: 1px;
            animation: fadeInUp 0.5s ease-out;
            word-break: break-all;
        }

        .referral-code-box:hover {
            background: rgba(214, 41, 57, 0.1);
            border-color: var(--accent-color);
            transform: translateY(-3px);
        }

        /* Referral Share Button */
        .referral-share-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
            box-shadow: var(--shadow-light);
        }

        .referral-share-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        /* Chart Styles */
        .chart-container {
            margin-top: 20px;
            padding: 20px;
            background: rgba(214, 41, 57, 0.05);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            animation: fadeInUp 0.5s ease-out;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--tg-theme-text-color);
        }

        .chart-price {
            font-size: 18px;
            font-weight: 700;
            color: var(--success-color);
        }

        .chart-change {
            font-size: 14px;
            font-weight: 500;
            padding: 4px 10px;
            border-radius: 6px;
        }

        .chart-change.positive {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success-color);
        }

        .chart-change.negative {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger-color);
        }

        .chart-placeholder {
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            color: var(--tg-theme-hint-color);
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .chart-placeholder:hover {
            background: rgba(214, 41, 57, 0.1);
        }

        .chart-info {
            text-align: center;
            margin-top: 10px;
            font-size: 12px;
            color: var(--tg-theme-hint-color);
        }

        /* TRX Chart Canvas */
        #trxChartCanvas {
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }

        /* Admin Styles */
        .admin-stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .admin-stat-card {
            background: rgba(214, 41, 57, 0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            text-align: center;
            transition: var(--transition);
            animation: fadeInUp 0.5s ease-out;
        }

        .admin-stat-card:hover {
            background: rgba(214, 41, 57, 0.1);
            transform: translateY(-3px);
        }

        .admin-stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--tg-theme-text-color);
            margin-bottom: 5px;
        }

        .admin-stat-label {
            font-size: 12px;
            color: var(--tg-theme-hint-color);
            text-transform: uppercase;
        }

        .admin-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .admin-control-btn {
            padding: 14px;
            background: var(--gradient-warning);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .admin-control-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .admin-control-btn.danger {
            background: var(--gradient-secondary);
        }

        /* Admin User List */
        .admin-user-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .admin-user-item {
            background: rgba(214, 41, 57, 0.05);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        .admin-user-item:hover {
            background: rgba(214, 41, 57, 0.1);
            transform: translateY(-2px);
        }

        .admin-user-info {
            flex: 1;
        }

        .admin-user-id {
            font-weight: bold;
            color: var(--tg-theme-text-color);
            margin-bottom: 5px;
        }

        .admin-user-balance {
            font-size: 12px;
            color: var(--tg-theme-hint-color);
            margin-bottom: 3px;
        }

        .admin-user-date {
            font-size: 11px;
            color: var(--tg-theme-hint-color);
        }

        .admin-user-actions {
            display: flex;
            gap: 5px;
        }

        .admin-action-btn {
            padding: 6px 10px;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: var(--transition);
        }

        .admin-action-btn:hover {
            transform: translateY(-2px);
        }

        /* Withdraw Requests */
        .withdraw-requests-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .withdraw-request-item {
            background: rgba(214, 41, 57, 0.05);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 10px;
            transition: var(--transition);
        }

        .withdraw-request-item:hover {
            background: rgba(214, 41, 57, 0.1);
            transform: translateY(-2px);
        }

        .withdraw-request-info {
            margin-bottom: 10px;
        }

        .withdraw-request-user {
            font-weight: bold;
            color: var(--tg-theme-text-color);
            margin-bottom: 5px;
        }

        .withdraw-request-details {
            font-size: 12px;
            color: var(--tg-theme-hint-color);
            margin-bottom: 3px;
        }

        .withdraw-request-address {
            font-size: 11px;
            color: var(--tg-theme-hint-color);
            background: rgba(214, 41, 57, 0.1);
            padding: 8px;
            border-radius: 6px;
            margin: 5px 0;
            cursor: pointer;
            transition: var(--transition);
            word-break: break-all;
        }

        .withdraw-request-address:hover {
            background: rgba(214, 41, 57, 0.2);
        }

        .withdraw-request-date {
            font-size: 11px;
            color: var(--tg-theme-hint-color);
        }

        .withdraw-request-actions {
            display: flex;
            gap: 10px;
        }

        .withdraw-action-btn {
            padding: 8px 12px;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: var(--transition);
        }

        .withdraw-action-btn.approve {
            background: var(--gradient-success);
        }

        .withdraw-action-btn.reject {
            background: var(--gradient-secondary);
        }

        .withdraw-action-btn:hover {
            transform: translateY(-2px);
        }

        /* Referral History */
        .referral-history {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .referral-history-item {
            background: rgba(214, 41, 57, 0.05);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 10px;
            transition: var(--transition);
        }

        .referral-history-item:hover {
            background: rgba(214, 41, 57, 0.1);
            transform: translateY(-2px);
        }

        .referral-history-user {
            font-weight: bold;
            color: var(--tg-theme-text-color);
            margin-bottom: 5px;
        }

        .referral-history-date {
            font-size: 12px;
            color: var(--tg-theme-hint-color);
        }

        .referral-history-bonus {
            font-size: 14px;
            color: var(--success-color);
            font-weight: bold;
        }

        /* About Styles */
        .about-section {
            margin-bottom: 20px;
        }

        .about-section h3 {
            color: var(--tg-theme-text-color);
            margin-bottom: 10px;
            font-size: 16px;
        }

        .about-section p {
            color: var(--tg-theme-hint-color);
            line-height: 1.6;
        }

        /* Countdown Timer */
        .countdown-timer {
            font-size: 14px;
            color: var(--tg-theme-hint-color);
            text-align: center;
            margin-top: 10px;
            font-weight: 500;
        }

        /* Ad Progress */
        .ad-progress {
            margin-top: 10px;
            text-align: center;
            font-size: 14px;
            color: var(--tg-theme-hint-color);
        }

        .ad-progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(214, 41, 57, 0.1);
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }

        .ad-progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .container {
                padding: 15px 10px 90px 10px;
            }
            .card {
                padding: 20px;
            }
            .balance-amount {
                font-size: 36px;
            }
            .btn {
                padding: 16px;
                font-size: 16px;
            }
            .footer-nav {
                padding: 10px 0;
            }
            .nav-btn {
                padding: 6px 12px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="container">

        <div id="loading" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--tg-theme-bg-color); z-index: 2000; display: flex; flex-direction: column; justify-content: center; align-items: center;">
            <i class="fas fa-spinner fa-spin" style="font-size: 50px; color: var(--tg-theme-button-color); margin-bottom: 20px;"></i>
            <p style="color: var(--tg-theme-hint-color);">Veriler yükleniyor...</p>
        </div>
        
        <div id="app" class="view" style="display: none;">

            <div id="home-view" class="view" style="display: block;">
                <div class="header">
                    <div class="logo-container">
                        <div class="logo">
                            <i class="fas fa-ad"></i>
                        </div>
                    </div>
                    <h1>TronAdsFaucet</h1>
                    <p>Watch Ads and Earn TRON</p>
                    <button class="admin-header-btn" id="adminButton" style="display: none;" onclick="showView('admin-view')">
                        <i class="fas fa-cog"></i> Admin
                    </button>
                </div>

                <div class="card">
                    <h2><i class="fas fa-chart-line"></i> TRON Price</h2>
                    <div class="chart-header">
                        <span class="chart-title">TRX/USD</span>
                        <span id="trxPrice" class="chart-price">$0.1200</span>
                    </div>
                </div>

                <div class="card">
                    <h2><i class="fas fa-wallet"></i> Current Balance</h2>
                    <div class="balance-amount" id="balanceAmount">
                        0.0000 USD (0.00 TRX)
                    </div>
                    
                    <div class="ad-buttons">
                        <button class="btn btn-primary" id="withdrawButton" onclick="toggleAdPanel()">
                            <i class="fas fa-dollar-sign"></i> Withdraw Funds
                        </button>
                        <button class="btn btn-success" id="adButton" onclick="toggleAdPanel()">
                            <i class="fas fa-eye"></i> Watch Ads
                        </button>
                    </div>

                    <div id="adPanel" style="display: none; flex-direction: column; gap: 15px;">
                        <div class="ad-info-grid">
                            <div class="ad-info-item">
                                <h3><span id="adCount">0</span></h3>
                                <p>Total Ads Watched</p>
                            </div>
                            <div class="ad-info-item">
                                <h3><span id="dailyAdCount">0</span>/10</h3>
                                <p>Daily Limit</p>
                            </div>
                        </div>
                        <button class="btn btn-success" onclick="startAdSession()">
                            <i class="fas fa-play"></i> Start Ad Session (Earn $0.0005)
                        </button>
                    </div>
                </div>

                <div id="withdraw-view" class="card view" style="display: none;">
                    <h2><i class="fas fa-sign-out-alt"></i> Withdraw TRX</h2>
                    
                    <div class="input-group">
                        <label for="withdrawAmount">Amount (USD)</label>
                        <input type="number" id="withdrawAmount" placeholder="Min $10.00 USD" value="10" min="10">
                    </div>
                    
                    <div class="input-group">
                        <label for="walletAddress">TRC20/TRX Wallet Address</label>
                        <input type="text" id="walletAddress" placeholder="T..." required>
                    </div>
                    
                    <button class="btn btn-primary" onclick="approveWithdrawal()">
                        <i class="fas fa-paper-plane"></i> Send Withdrawal Request
                    </button>
                </div>

                <div class="card">
                    <h2><i class="fas fa-user-friends"></i> Referral Program</h2>
                    <p style="color: var(--tg-theme-hint-color); font-size: 14px; margin-bottom: 15px;">Invite friends and earn 5% of their ad earnings!</p>
                    
                    <p style="font-size: 14px; font-weight: 500; margin-bottom: 8px;">Your Referral Code (Click to Copy):</p>
                    <div class="referral-code-box" id="referralCodeBox" onclick="copyReferralCode()">
                        Loading...
                    </div>

                    <a id="referralLink" href="#" target="_blank" style="display: block; font-size: 12px; color: var(--tg-theme-button-color); margin-top: 10px; word-break: break-all;"></a>

                    <button class="referral-share-btn" onclick="copyReferralLink()">
                        <i class="fas fa-share-alt"></i> Copy Share Link
                    </button>
                </div>
            </div>

            <div id="admin-view" class="view" style="display: none;">
                <div class="header">
                    <h1>Admin Panel</h1>
                    <p>Manage Withdrawals and Users</p>
                </div>

                <div class="card">
                    <h2><i class="fas fa-clipboard-list"></i> Pending Withdrawals</h2>
                    <div id="withdrawalRequests" class="withdraw-requests-list">
                        <p>Loading requests...</p>
                    </div>
                </div>
            </div>

            <div id="about-view" class="view" style="display: none;">
                <div class="header">
                    <h1>About</h1>
                </div>
                <div class="card">
                    <h2><i class="fas fa-info-circle"></i> Application Info</h2>
                    <div class="about-section">
                        <h3>How it Works</h3>
                        <p>This is a Telegram Mini App faucet allowing users to earn small amounts of TRX (represented as USD) by watching ads. Earnings are tracked in USD and converted to TRX using the current market price upon display and withdrawal.</p>
                        <h3>Data Storage</h3>
                        <p>User data (balance, referral codes, ad counts, withdrawals) is securely stored using <strong>JsonBin.io</strong> as a persistent database.</p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="footer-nav">
        <button class="nav-btn active" onclick="showView('home-view')">
            <span class="icon"><i class="fas fa-home"></i></span> Home
        </button>
        <button class="nav-btn" onclick="showView('referral-view')">
            <span class="icon"><i class="fas fa-user-friends"></i></span> Refer
        </button>
        <button class="nav-btn" onclick="showView('withdraw-view')">
            <span class="icon"><i class="fas fa-dollar-sign"></i></span> Withdraw
        </button>
        <button class="nav-btn" onclick="showView('about-view')">
            <span class="icon"><i class="fas fa-info-circle"></i></span> About
        </button>
    </div>
    
    <div id="statusMessage" class="status-message"></div>

    <script>
        // ********************************************
        // * JSONBIN CONFIGURATION           *
        // ********************************************
        // KULLANICI TARAFINDAN GİRİLEN BİLGİLER
        const JSONBIN_API_KEY = '$2a$10$Z5pw8wmihH97EgC6kgHAoebiEzuzhHLO361BA7ZAdTLZR.NY1gfK6'; // X-Master-Key
        const JSONBIN_BIN_ID = '68e2b3ebd0ea881f40965de6'; 
        const JSONBIN_API_URL = `https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`;

        // Admin kullanıcı ID'leri (Kendi Telegram ID'nizi buraya ekleyin)
        const ADMIN_USER_IDS = [
            '123456789' 
        ];
        
        const MIN_WITHDRAWAL = 10; // Minimum çekim limiti (USD)
        const REFERRAL_REWARD_PERCENTAGE = 0.05; // %5

        const appState = {
            userId: null,
            username: 'Anonim',
            isAdmin: false,
            balance: 0, // Kullanıcının USD cinsinden bakiyesi
            tronPrice: 0.12, // Başlangıç TRX fiyatı (API'den güncellenecek)
            referralCode: 'LOADING',
            adCount: 0,
            dailyAdCount: 0,
            lastAdReset: Date.now(),
            totalAds: 2, // Bir reklam oturumunda gösterilecek reklam sayısı
            totalAdReward: 0.0005, // Bir reklam oturumundan kazanılan USD miktarı
            isAdPanelVisible: false,
            // JsonBin'den çekilen tüm veriler
            allUsers: {}, 
            withdrawals: [] 
        };

        const elements = {
            balanceAmount: document.getElementById('balanceAmount'),
            referralCodeBox: document.getElementById('referralCodeBox'),
            referralLink: document.getElementById('referralLink'),
            adCountDisplay: document.getElementById('adCount'),
            dailyAdCountDisplay: document.getElementById('dailyAdCount'),
            adPanel: document.getElementById('adPanel'),
            withdrawAmount: document.getElementById('withdrawAmount'),
            walletAddress: document.getElementById('walletAddress'),
            withdrawButton: document.getElementById('withdrawButton'),
            adminPanel: document.getElementById('admin-view'),
            withdrawalRequests: document.getElementById('withdrawalRequests'),
            adminButton: document.getElementById('adminButton'),
            trxPriceDisplay: document.getElementById('trxPrice'),
            loadingScreen: document.getElementById('loading')
        };
        
        // Element kısaltmaları
        const referralCodeBox = elements.referralCodeBox;

        // ********************************************
        // * JSONBIN DATA HANDLERS           *
        // ********************************************

        async function fetchAllData() {
            try {
                // Bin ID ve Master Key ile verileri çek
                const response = await fetch(JSONBIN_API_URL, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': JSONBIN_API_KEY 
                    }
                });
                if (!response.ok) throw new Error(`HTTP Hata! Durum: ${response.status}`);
                
                const data = await response.json();
                return data.record;
            } catch (error) {
                console.error('JsonBin Veri Çekme Hatası:', error);
                // Başarısız olursa varsayılan boş yapıyı döndür
                showStatus('Veritabanına bağlanılamadı. Lütfen API/Bin ID\'yi kontrol edin.', 'error');
                return { users: {}, withdrawals: [] };
            }
        }

        async function saveAllData(data) {
            try {
                // Verileri PUT (kaydet/güncelle) ile JsonBin'e gönder
                const response = await fetch(JSONBIN_API_URL, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': JSONBIN_API_KEY, 
                        'X-Bin-Versioning': 'false' // Versiyonlamayı kapatmak daha iyidir
                    },
                    body: JSON.stringify(data)
                });
                if (!response.ok) throw new Error(`HTTP Hata! Durum: ${response.status}`);
                console.log('Veriler JsonBin\'e kaydedildi.');
            } catch (error) {
                console.error('JsonBin Veri Kaydetme Hatası:', error);
                showStatus('Veri Kaydetme Hatası! Lütfen tekrar deneyin.', 'error');
            }
        }

        async function saveUserSpecificData() {
            // Sadece kullanıcının kendi verilerini appState'ten alıp allUsers objesine yazar ve kaydeder
            appState.allUsers[appState.userId] = {
                id: appState.userId,
                balance: appState.balance,
                referralCode: appState.referralCode,
                adCount: appState.adCount,
                dailyAdCount: appState.dailyAdCount,
                lastAdReset: appState.lastAdReset,
                isAdPanelVisible: appState.isAdPanelVisible
            };
            await saveAllData({ users: appState.allUsers, withdrawals: appState.withdrawals });
        }
        
        // ********************************************
        // * UTILITY & UI FUNCTIONS       *
        // ********************************************

        function generateReferralCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase();
        }

        function showStatus(message, type = 'info') {
            // Telegram WebApp uyarısı
            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                Telegram.WebApp.showAlert(message);
            } else {
                alert(message);
            }
        }

        async function fetchTronPrice() {
            try {
                // CoinGecko'dan anlık TRX fiyatını çeker
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=tron&vs_currencies=usd');
                const data = await response.json();
                appState.tronPrice = data.tron.usd;
                elements.trxPriceDisplay.textContent = `1 TRX = $${appState.tronPrice.toFixed(4)}`;
            } catch (error) {
                console.error('TRX fiyatı çekilemedi:', error);
                showStatus('TRX fiyatı yüklenemedi. Varsayılan $0.12 kullanılıyor.', 'warning');
            }
        }

        function showView(viewId) {
            document.querySelectorAll('.view').forEach(view => {
                view.style.display = 'none';
            });
            document.getElementById(viewId).style.display = 'block';

            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Aktif navigasyon butonunu bul ve active sınıfı ekle
            const navButtons = document.querySelectorAll('.footer-nav button');
            if (viewId === 'home-view' || viewId === 'ad-panel') {
                 navButtons[0].classList.add('active'); // Home butonu
            } else if (viewId === 'referral-view') {
                 navButtons[1].classList.add('active'); // Refer butonu
                 document.getElementById('home-view').style.display = 'block'; // Navigasyon butonu home view içinde olmadığı için
            } else if (viewId === 'withdraw-view') {
                 navButtons[2].classList.add('active'); // Withdraw butonu
                 document.getElementById('home-view').style.display = 'block';
            } else if (viewId === 'about-view') {
                 navButtons[3].classList.add('active'); // About butonu
            } else if (viewId === 'admin-view') {
                // Admin butonu navigasyonda değil
            }
            
            // Eğer çekim veya reklam paneli açıksa, home view'i göster ama panelin kendisini göster
            if (viewId === 'withdraw-view' || viewId === 'ad-panel') {
                document.getElementById('home-view').style.display = 'block';
            }
        }

        function updateUI() {
            const balanceInTRX = appState.balance / appState.tronPrice;
            
            elements.balanceAmount.textContent = `${appState.balance.toFixed(4)} USD (${balanceInTRX.toFixed(2)} TRX)`;
            elements.adCountDisplay.textContent = appState.adCount;
            elements.dailyAdCountDisplay.textContent = `${appState.dailyAdCount}/10`;
            // Ref kodu düzeltmesi: Veriler yüklendikten sonra kodu göster
            referralCodeBox.textContent = appState.referralCode; 
            
            // Referans linki
            const botUsername = (Telegram.WebApp && Telegram.WebApp.initDataUnsafe.chat_id) ? 'YOUR_BOT_USERNAME' : 'YOUR_BOT_USERNAME'; // Buraya botunuzun kullanıcı adını yazın
            const refLink = `https://t.me/${botUsername}?start=${appState.referralCode}`;
            elements.referralLink.href = refLink;
            elements.referralLink.textContent = refLink;

            // Reklam/Çekim paneli görünürlüğünü güncelle
            if (appState.isAdPanelVisible) {
                elements.adPanel.style.display = 'flex';
                elements.withdrawButton.style.display = 'none';
                document.getElementById('withdraw-view').style.display = 'none';
                
            } else {
                elements.adPanel.style.display = 'none';
                elements.withdrawButton.style.display = 'flex';
                
                // Eğer navigasyon çubuğundan Withdraw seçilmişse sadece çekim panelini göster
                const withdrawNavActive = document.querySelector('.footer-nav button:nth-child(3)').classList.contains('active');
                if (withdrawNavActive) {
                    document.getElementById('withdraw-view').style.display = 'block';
                } else {
                    document.getElementById('withdraw-view').style.display = 'none';
                }
            }
        }
        
        function checkDailyReset() {
            const twentyFourHours = 24 * 60 * 60 * 1000;
            if (Date.now() - appState.lastAdReset > twentyFourHours) {
                appState.dailyAdCount = 0;
                appState.lastAdReset = Date.now();
                saveUserSpecificData(); // Güncelleme sonrası kaydet
            }
        }

        // ********************************************
        // * MAIN LOGIC                  *
        // ********************************************

        window.startAdSession = function() {
            if (appState.dailyAdCount >= 10) {
                showStatus('Günlük reklam limitinize ulaştınız (10 reklam). Lütfen yarın tekrar deneyin.', 'warning');
                return;
            }

            // Reklam oturumunu başlat
            if (window.Adexora && window.Adexora.startAdSession) {
                window.Adexora.startAdSession({
                    adCount: appState.totalAds,
                    adReward: appState.totalAdReward,
                    onComplete: completeAdSession,
                    onFail: () => showStatus('Reklam yüklenemedi veya bir hata oluştu.', 'error')
                });

                showStatus('Reklamlar yükleniyor...', 'info');
            } else {
                showStatus('Adexora SDK yüklenemedi. Test için ödül hemen eklendi.', 'warning');
                completeAdSession(); // SDK yüklenmezse ödülü ekleyerek test etme imkanı
            }
        };

        function completeAdSession() {
            // Reklam oturumundan kazanılan USD miktarı
            const rewardInUSD = appState.totalAdReward; 
            
            // Reklam izleme ödülü
            // DÜZELTME: USD bazlı ödülü, USD bazlı bakiyeye ekle
            appState.balance += rewardInUSD; 
            
            appState.adCount += appState.totalAds;
            appState.dailyAdCount += appState.totalAds;

            // Referans (Ref) ödülü kontrolü
            const urlParams = new URLSearchParams(Telegram.WebApp.initData || '');
            const refCode = urlParams.get('start');
            
            if (refCode && refCode !== appState.referralCode) {
                const referrerId = Object.keys(appState.allUsers).find(id => appState.allUsers[id].referralCode === refCode);
                
                if (referrerId && referrerId !== appState.userId) {
                    const referralReward = rewardInUSD * REFERRAL_REWARD_PERCENTAGE;
                    
                    // Yönlendiren kullanıcının bakiyesini güncelle
                    appState.allUsers[referrerId].balance = (appState.allUsers[referrerId].balance || 0) + referralReward;
                    
                    showStatus(`Tebrikler! ${refCode} kodunu kullanan bir kullanıcı reklam izledi. Size $${referralReward.toFixed(4)} eklendi.`, 'success');
                }
            }

            // Verileri JsonBin'e kaydet
            saveUserSpecificData();
            
            showStatus(`Tebrikler! $${rewardInUSD.toFixed(4)} kazandınız.`, 'success');
            updateUI();
        }

        window.toggleAdPanel = function() {
            // Eğer çekim/reklam paneli kapalıysa aç, açıksa kapat
            appState.isAdPanelVisible = !appState.isAdPanelVisible; 
            updateUI();
            saveUserSpecificData();
        };

        window.copyReferralCode = function() {
            navigator.clipboard.writeText(appState.referralCode).then(() => {
                showStatus('Referans kodu kopyalandı: ' + appState.referralCode, 'info');
            }).catch(() => {
                 showStatus('Kopyalama başarısız oldu.', 'error');
            });
        };

        window.copyReferralLink = function() {
            const refLink = elements.referralLink.href;
            navigator.clipboard.writeText(refLink).then(() => {
                showStatus('Referans linki kopyalandı.', 'info');
            }).catch(() => {
                 showStatus('Kopyalama başarısız oldu.', 'error');
            });
        };

        window.approveWithdrawal = async function() {
            const amount = parseFloat(elements.withdrawAmount.value);
            const walletAddress = elements.walletAddress.value.trim();

            if (isNaN(amount) || amount <= 0 || amount > appState.balance) {
                showStatus(`Geçersiz çekim miktarı. Mevcut bakiyeniz: $${appState.balance.toFixed(4)}`, 'error');
                return;
            }
            if (amount < MIN_WITHDRAWAL) {
                 showStatus(`Minimum çekim limiti $${MIN_WITHDRAWAL.toFixed(2)}'dır.`, 'error');
                 return;
            }
            if (!walletAddress || walletAddress.length < 10) {
                showStatus('Geçerli bir TRC20/TRX adresi giriniz.', 'error');
                return;
            }

            const newWithdrawal = {
                id: Date.now().toString(),
                userId: appState.userId,
                username: appState.username,
                amount: amount,
                address: walletAddress,
                date: new Date().toLocaleString(),
                status: 'pending'
            };

            // Bakiyeden düş
            appState.balance -= amount;
            
            // Yeni çekim isteğini appState.withdrawals'a ekle
            appState.withdrawals.push(newWithdrawal);
            
            // Verileri JsonBin'e kaydet
            await saveAllData({ users: appState.allUsers, withdrawals: appState.withdrawals });
            
            // Kullanıcının kendi verilerini de kaydet
            await saveUserSpecificData();

            updateUI();
            showStatus(`Çekim isteği oluşturuldu. $${amount.toFixed(4)} bakiyenizden düşüldü.`, 'success');
        };

        // ********************************************
        // * ADMIN PANEL LOGIC            *
        // ********************************************

        function updateAdminPanel() {
            elements.withdrawalRequests.innerHTML = '';
            
            // Sadece beklemede olanları göster
            const pendingWithdrawals = appState.withdrawals.filter(w => w.status === 'pending');

            if (pendingWithdrawals.length === 0) {
                elements.withdrawalRequests.innerHTML = '<p>Bekleyen çekim isteği yok.</p>';
                return;
            }

            pendingWithdrawals.forEach(withdrawal => {
                const withdrawalElement = document.createElement('div');
                withdrawalElement.className = 'withdraw-request-item';
                withdrawalElement.innerHTML = `
                    <div class="withdraw-request-info">
                        <p class="withdraw-request-user">Kullanıcı: ${withdrawal.username} (${withdrawal.userId})</p>
                        <p class="withdraw-request-details">Miktar: <strong>$${withdrawal.amount.toFixed(4)}</strong> (${(withdrawal.amount / appState.tronPrice).toFixed(2)} TRX)</p>
                        <p class="withdraw-request-address" onclick="navigator.clipboard.writeText('${withdrawal.address}'); showStatus('Adres kopyalandı.', 'info');">
                            Adres: <code>${withdrawal.address}</code>
                        </p>
                        <p class="withdraw-request-date">Tarih: ${withdrawal.date}</p>
                    </div>
                    <div class="withdraw-request-actions">
                        <button onclick="adminApproveWithdrawal('${withdrawal.id}')" class="withdraw-action-btn approve">Onayla</button>
                        <button onclick="adminRejectWithdrawal('${withdrawal.id}')" class="withdraw-action-btn reject">Reddet</button>
                    </div>
                `;
                elements.withdrawalRequests.appendChild(withdrawalElement);
            });
        }

        window.adminApproveWithdrawal = async function(withdrawalId) {
            const withdrawalIndex = appState.withdrawals.findIndex(w => w.id === withdrawalId);
            
            if (withdrawalIndex !== -1) {
                appState.withdrawals[withdrawalIndex].status = 'completed';
                // Verileri JsonBin'e kaydet
                await saveAllData({ users: appState.allUsers, withdrawals: appState.withdrawals });
                updateAdminPanel();
                showStatus('Çekim isteği onaylandı.', 'success');
            }
        };

        window.adminRejectWithdrawal = async function(withdrawalId) {
            const withdrawalIndex = appState.withdrawals.findIndex(w => w.id === withdrawalId);
            
            if (withdrawalIndex !== -1) {
                const withdrawal = appState.withdrawals[withdrawalIndex];
                
                // Reddedilen miktarı kullanıcının bakiyesine geri yükle
                if (appState.allUsers[withdrawal.userId]) {
                    appState.allUsers[withdrawal.userId].balance = (appState.allUsers[withdrawal.userId].balance || 0) + withdrawal.amount;
                }
                
                // Çekim isteğini listeden kaldır
                appState.withdrawals.splice(withdrawalIndex, 1);
                
                // Verileri JsonBin'e kaydet
                await saveAllData({ users: appState.allUsers, withdrawals: appState.withdrawals });
                
                // Eğer bakiye iadesi bu kullanıcıya aitse UI'ı güncelle
                if (appState.userId === withdrawal.userId) {
                    appState.balance += withdrawal.amount;
                    updateUI();
                }

                updateAdminPanel();
                showStatus('Çekim isteği reddedildi ve bakiye iade edildi.', 'success');
            }
        };

        // ********************************************
        // * INITIALIZATION               *
        // ********************************************

        async function loadUserData() {
            // Tüm veriyi JsonBin'den çek
            const allData = await fetchAllData();
            appState.allUsers = allData.users || {};
            appState.withdrawals = allData.withdrawals || [];
            
            const userData = appState.allUsers[appState.userId];

            if (userData) {
                // Mevcut kullanıcı verilerini appState'e yükle
                appState.balance = userData.balance || 0;
                appState.referralCode = userData.referralCode;
                appState.adCount = userData.adCount || 0;
                appState.dailyAdCount = userData.dailyAdCount || 0;
                appState.lastAdReset = userData.lastAdReset;
                appState.isAdPanelVisible = userData.isAdPanelVisible;
            } else {
                // Yeni kullanıcı oluştur
                appState.referralCode = generateReferralCode();
                appState.allUsers[appState.userId] = {
                    id: appState.userId,
                    balance: 0,
                    referralCode: appState.referralCode,
                    adCount: 0,
                    dailyAdCount: 0,
                    lastAdReset: Date.now(),
                    isAdPanelVisible: false
                };
                // Yeni kullanıcıyı kaydet
                await saveAllData({ users: appState.allUsers, withdrawals: appState.withdrawals });
            }

            checkDailyReset();
            
            // UI'ı sadece veriler yüklendikten sonra güncelle
            updateUI();
            
            // Admin panelini sadece veriler yüklendikten sonra güncelle
            if (appState.isAdmin) {
                updateAdminPanel();
            }
            
            // Yükleme ekranını kaldır ve uygulamayı göster
            elements.loadingScreen.style.display = 'none';
            document.getElementById('app').style.display = 'flex';
        }

        function initApp() {
            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
                
                // Kullanıcı ID'sini ve Kullanıcı Adını al
                appState.userId = Telegram.WebApp.initDataUnsafe.user.id.toString() || 'guest_user';
                appState.username = Telegram.WebApp.initDataUnsafe.user.username || appState.userId;
            } else {
                // Tarayıcı testi için sahte ID
                appState.userId = 'test_user_id';
            }

            // Admin kontrolü
            if (ADMIN_USER_IDS.includes(appState.userId)) {
                appState.isAdmin = true;
                elements.adminButton.style.display = 'flex';
                elements.adminPanel.style.display = 'block';
            }

            fetchTronPrice();
            loadUserData(); // Veriyi çek ve uygulamayı başlat
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
